<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chapter 05: Spatial Analysis | GIS Digital Textbook</title>
    <meta name="description" content="Unlock the power of GIS analysis. Learn about overlay, buffering, map algebra, and network analysis.">
    <link rel="stylesheet" href="../css/style.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&family=Outfit:wght@300;400;600;800&display=swap" rel="stylesheet">
    <style>
        /* Chapter-specific styles */
        .hero-chapter {
            background: linear-gradient(
                135deg,
                rgba(30, 27, 75, 0.9) 0%,
                rgba(76, 29, 149, 0.8) 50%,
                rgba(139, 92, 246, 0.9) 100%
            ),
            url("../assets/img/hero_chapter05.png");
            background-size: cover;
            background-position: center;
            background-attachment: fixed;
            padding: 5rem 2rem;
            text-align: center;
            position: relative;
            overflow: hidden;
        }

        .hero-chapter .container {
            position: relative;
            z-index: 1;
        }

        .chapter-badge {
            display: inline-block;
            background: linear-gradient(135deg, #8b5cf6, #a78bfa);
            color: white;
            padding: 0.5rem 1.5rem;
            border-radius: 30px;
            font-size: 0.9rem;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 0.15em;
            margin-bottom: 1.5rem;
            box-shadow: 0 4px 15px rgba(139, 92, 246, 0.4);
        }

        .hero-chapter h1 {
            font-size: clamp(2.5rem, 5vw, 4rem);
            margin-bottom: 1rem;
            background: linear-gradient(135deg, #ffffff 0%, #a8d8ea 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            text-shadow: 0 4px 10px rgba(0,0,0,0.3);
        }

        .hero-chapter .subtitle {
            font-size: 1.25rem;
            color: rgba(255, 255, 255, 0.9);
            max-width: 700px;
            margin: 0 auto 2rem;
            line-height: 1.7;
            text-shadow: 0 2px 4px rgba(0,0,0,0.3);
        }

        .layout-grid {
            display: grid;
            grid-template-columns: 1fr 340px;
            gap: 2rem;
            margin-top: 3rem;
        }

        @media (max-width: 1100px) {
            .layout-grid { grid-template-columns: 1fr; }
        }

        .card { background: white; padding: 2.5rem; border-radius: 16px; margin-bottom: 2rem; box-shadow: 0 4px 6px rgba(0,0,0,0.02); }
        .callout { padding: 1.5rem; border-radius: 12px; margin-top: 1.5rem; display: flex; gap: 1rem; align-items: flex-start; background: #f5f3ff; border-left: 5px solid var(--primary); color: #4c1d95; }
        
        /* Analysis Icons Grid */
        .analysis-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1.5rem;
            margin-top: 2rem;
        }
        .analysis-item {
            background: #fff;
            border: 1px solid #e2e8f0;
            border-radius: 12px;
            padding: 1.5rem;
            text-align: center;
            transition: transform 0.2s;
        }
        .analysis-item:hover { transform: translateY(-5px); border-color: var(--primary); }
        .analysis-icon { font-size: 2.5rem; margin-bottom: 1rem; display: block; }
        
        .sidebar-box {
            background: white;
            border-radius: 12px;
            padding: 1.5rem;
            margin-bottom: 2rem;
            box-shadow: 0 4px 20px rgba(0,0,0,0.05);
            border-top: 4px solid var(--primary);
        }

        /* Quiz Styles */
        .quiz-container { background: #f8fafc; padding: 2rem; border-radius: 16px; margin-top: 3rem; border: 1px solid #e2e8f0; }
        .btn-quiz {
            padding: 0.75rem 1rem;
            background: white;
            border: 2px solid #e2e8f0;
            border-radius: 8px;
            cursor: pointer;
            text-align: left;
            transition: all 0.2s;
            width: 100%;
            margin-bottom: 0.5rem;
        }
        .btn-quiz:hover { border-color: #3b82f6; background: #eff6ff; }
    </style>
    <script>
        function updateSuitability() {
            const wNature = parseInt(document.getElementById('w-nature').value);
            const wRoad = parseInt(document.getElementById('w-road').value);
            const wSlope = parseInt(document.getElementById('w-slope').value);
            
            // Normalize so they sum to 100% implicitly by ratio? No, let's just show the sum warning if it's off.
            // Or simpler: Just sum them up and show the percentage.
            const sum = wNature + wRoad + wSlope;
            const sumDisplay = document.getElementById('weight-sum');
            
            if(sum === 0) {
                 sumDisplay.innerHTML = "Total: 0% (Move sliders!)";
                 return; 
            }

            sumDisplay.innerHTML = `Total Weight: ${sum}% ` + (sum!==100 ? "(Try to aim for 100!)" : "(Perfect!)");
            sumDisplay.style.color = sum === 100 ? "var(--success)" : "var(--accent)";

            // Calculate Scores (0-100)
            // Site A: Nature 100, Road 0, Slope 20 (Bad slope)
            // Site B: Nature 10, Road 100, Slope 100 (Flat)
            // Site C: Nature 60, Road 60, Slope 60 (Moderate)
            
            const scoreA = (100 * wNature + 0 * wRoad + 20 * wSlope) / sum;
            const scoreB = (10 * wNature + 100 * wRoad + 100 * wSlope) / sum;
            const scoreC = (60 * wNature + 60 * wRoad + 60 * wSlope) / sum;
            
            updateBar('site-a', scoreA);
            updateBar('site-b', scoreB);
            updateBar('site-c', scoreC);
        }
        
        function updateBar(id, score) {
            const el = document.querySelector(`#${id} .score-bar div`);
            el.style.width = score + "%";
            // Color code
            if(score > 80) el.style.background = "var(--success)";
            else if(score > 50) el.style.background = "var(--primary)";
            else el.style.background = "var(--accent)";
        }
        
        // Init
        window.onload = function() { updateSuitability(); };
    </script>
</head>
<body>

    <header class="hero-chapter">
        <div class="container">
            <span class="chapter-badge">Chapter 05</span>
            <h1>Spatial Analysis</h1>
            <p class="subtitle">Data is just the raw material. Analysis is the refined product. Learn how to query, overlay, and model the world to answer "What if?"</p>
        </div>
    </header>
    <!-- STICKY NAVIGATION BAR -->
    <nav class="sticky-chapter-bar">
      <div class="nav-container">
        <div class="nav-left">
          <span class="nav-chapter-num">Chapter 05</span>
        </div>
        <div class="nav-center">
          <span class="nav-current-title">Spatial Analysis</span>
        </div>
        <div class="nav-right">
          <a href="../index.html" class="nav-toc-btn" title="Table of Contents">
            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="8" y1="6" x2="21" y2="6"></line><line x1="8" y1="12" x2="21" y2="12"></line><line x1="8" y1="18" x2="21" y2="18"></line><line x1="3" y1="6" x2="3.01" y2="6"></line><line x1="3" y1="12" x2="3.01" y2="12"></line><line x1="3" y1="18" x2="3.01" y2="18"></line></svg>
            <span class="toc-text">TOC</span>
          </a>
        </div>
      </div>
      <div class="nav-progress-bar"></div>
    </nav>


    <main class="container">
        

        <section class="card learning-scaffold">
            <details class="learning-scaffold-details">
  <summary>
<div class="scaffold-head">
                <h2>At a Glance</h2>
                <div class="scaffold-meta">
                    <span class="scaffold-chip"><strong>Prereqs:</strong> Ch 01-04</span>
                    <span class="scaffold-chip"><strong>Time:</strong> 40 min read + Lab</span>
                    <span class="scaffold-chip"><strong>Deliverable:</strong> Suitability Model</span>
                </div>
            </div>
  </summary>
            <div class="scaffold-grid">
                <div>
                    <h3>Learning Outcomes</h3>
                    <ul>
                        <li>Perform attribute (SQL) and spatial queries.</li>
                        <li>Execute vector overlay operations (Intersect, Union, Clip).</li>
                        <li>Apply Raster Map Algebra for site suitability.</li>
                        <li>Understand proximity tools like Buffering.</li>
                    </ul>
                </div>
                <div>
                    <h3>Key Terms</h3>
                    <p>Buffer, Intersect, Union, SQL, Map Algebra, Euclidean Distance, Boolean Logic</p>
                </div>
            </div>
        </details></section>

        <div class="layout-grid">
            <div class="content">
                <section class="card">
                    <h2>The Analysis Workflow</h2>
                    <p>Analysis usually falls into four categories. Before clicking a tool, identify which category your question belongs to:</p>
                    <div class="analysis-grid">
                        <div class="analysis-item">
                            <span class="analysis-icon">üîç</span>
                            <strong>Selection</strong>
                            <p>Finding "Where is it?" (Query)</p>
                        </div>
                        <div class="analysis-item">
                            <span class="analysis-icon">üìè</span>
                            <strong>Measurement</strong>
                            <p>Calculating Distance, Area, & Stats</p>
                        </div>
                        <div class="analysis-item">
                            <span class="analysis-icon">ü•û</span>
                            <strong>Overlay</strong>
                            <p>Stacking layers to find intersections</p>
                        </div>
                        <div class="analysis-item">
                            <span class="analysis-icon">üï∏Ô∏è</span>
                            <strong>Connectivity</strong>
                            <p>Networks and Surfaces</p>
                        </div>
                    </div>
                </section>

                <section class="card">
                    <h2>1. Selection & Query</h2>
                    <p><strong>Attribute Query (SQL):</strong> Selecting features based on their data table. <br><em>Example:</em> <code>SELECT * FROM Cities WHERE Population > 1,000,000</code></p>
                    <p><strong>Spatial Query:</strong> Selecting features based on location. <br><em>Example:</em> "Select all schools within 1 mile of a hazardous waste site."</p>
                    <div class="callout">
                        <strong>Boolean Logic:</strong> Queries often use AND, OR, and NOT. <br>
                        - <strong>AND</strong> restricts results (must meet both criteria).<br>
                        - <strong>OR</strong> expands results (can meet either criteria).
                    </div>
                </section>

                <section class="card">
                    <h2>2. Vector Overlay Analysis</h2>
                    <p>Overlay combines the geometry and attributes of two layers. It is the "cookie cutter" of GIS.</p>
                    <div style="display: grid; gap: 1rem; grid-template-columns: repeat(3, 1fr); margin-top: 1rem;">
                        <div style="text-align: center;">
                            <div style="height: 100px; background: #e0e7ff; border: 2px solid #6366f1; border-radius: 8px; display: flex; align-items: center; justify-content: center;"><strong>Intersect</strong></div>
                            <p style="font-size: 0.9rem; margin-top: 0.5rem;">AND (Common area only)</p>
                        </div>
                        <div style="text-align: center;">
                            <div style="height: 100px; background: #e0e7ff; border: 2px solid #6366f1; border-radius: 8px; display: flex; align-items: center; justify-content: center;"><strong>Union</strong></div>
                            <p style="font-size: 0.9rem; margin-top: 0.5rem;">OR (All areas combined)</p>
                        </div>
                        <div style="text-align: center;">
                            <div style="height: 100px; background: #e0e7ff; border: 2px solid #6366f1; border-radius: 8px; display: flex; align-items: center; justify-content: center;"><strong>Clip</strong></div>
                            <p style="font-size: 0.9rem; margin-top: 0.5rem;">Cookie Cutter (Input cut by Boundary)</p>
                        </div>
                    </div>
                </section>

                <section class="card">
                    <h2>3. Raster Map Algebra</h2>
                    <p>Raster analysis often treats layers like math variables. If you have two grids, you can add them, subtract them, or find the average. This is essential for <strong>Site Suitability Modeling</strong>.</p>
                    
                    <div style="margin-top: 1.5rem;">
                        <img src="../assets/img/diagrams/raster_map_algebra_diagram.png" alt="Raster Map Algebra Diagram" style="width: 100%; border-radius: 12px; box-shadow: 0 4px 6px rgba(0,0,0,0.1);">
                        <p style="font-size: 0.8rem; color: var(--secondary); margin-top: 0.5rem; text-align: center;">Figure 5.4: Basic Map Algebra operations. Notice how 'Add' sums the value of each overlapping cell.</p>
                    </div>

                    <div style="margin-top: 3rem; background: #fff; border: 1px solid #e2e8f0; border-radius: 12px; padding: 2rem;">
                        <h3>Interactive: Suitability Studio</h3>
                        <p>You are siting a new <strong>Eco-Lodge</strong>. Adjust the importance (weights) of the three factors below to see which site wins. (Note: Everything must sum to 100%).</p>
                        
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 2rem; align-items: start;">
                            <div class="controls">
                                <label style="display:block; margin-bottom:0.5rem; font-weight:600;">Nature View (0-100%)</label>
                                <input type="range" id="w-nature" min="0" max="100" value="50" oninput="updateSuitability()" style="width:100%; margin-bottom:1rem;">
                                
                                <label style="display:block; margin-bottom:0.5rem; font-weight:600;">Road Access (0-100%)</label>
                                <input type="range" id="w-road" min="0" max="100" value="50" oninput="updateSuitability()" style="width:100%; margin-bottom:1rem;">
                                
                                <label style="display:block; margin-bottom:0.5rem; font-weight:600;">Flat Slope (0-100%)</label>
                                <input type="range" id="w-slope" min="0" max="100" value="0" oninput="updateSuitability()" style="width:100%; margin-bottom:1rem;">
                                
                                <p id="weight-sum" style="font-size: 0.9rem; color: var(--secondary);">Total Weight: 100% (Balanced)</p>
                            </div>
                            
                            <div class="results">
                                <div class="site-card" id="site-a" style="padding:1rem; border:1px solid #cbd5e1; border-radius:8px; margin-bottom:0.5rem;">
                                    <strong>Site A (Mountain Top)</strong>
                                    <div class="score-bar" style="height:8px; background:#ddd; margin-top:5px; border-radius:4px;"><div style="width:0%; height:100%; background:var(--primary); transition:width 0.3s;"></div></div>
                                    <small>Great View, No Road, Steep.</small>
                                </div>
                                <div class="site-card" id="site-b" style="padding:1rem; border:1px solid #cbd5e1; border-radius:8px; margin-bottom:0.5rem;">
                                    <strong>Site B (Valley Highway)</strong>
                                    <div class="score-bar" style="height:8px; background:#ddd; margin-top:5px; border-radius:4px;"><div style="width:0%; height:100%; background:var(--primary); transition:width 0.3s;"></div></div>
                                    <small>Bad View, Great Road, Flat.</small>
                                </div>
                                <div class="site-card" id="site-c" style="padding:1rem; border:1px solid #cbd5e1; border-radius:8px;">
                                    <strong>Site C (Foothills)</strong>
                                    <div class="score-bar" style="height:8px; background:#ddd; margin-top:5px; border-radius:4px;"><div style="width:0%; height:100%; background:var(--primary); transition:width 0.3s;"></div></div>
                                    <small>Okay View, Okay Road, Moderate.</small>
                                </div>
                            </div>
                        </div>
                    </div>
                </section>

                <section class="card">
                    <h2>Spatial Theory: Von Th√ºnen's Isolated State</h2>
                    <p>Before GIS existed, economists were already thinking spatially. <strong>Johann Heinrich von Th√ºnen</strong> (1783‚Äì1850) was a German landowner who developed one of the first formal models of <strong>spatial economics</strong>‚Äîexplaining how distance from a market affects land use.</p>
                    
                    <div style="display: flex; gap: 2rem; align-items: flex-start; flex-wrap: wrap; margin-top: 1.5rem;">
                        <div style="flex: 1; min-width: 300px;">
                            <img src="../assets/img/vonthunen.png" alt="Von Th√ºnen's Isolated State model showing concentric rings of land use around a central market, with modification along a river transportation corridor" style="width: 100%; border-radius: 12px; box-shadow: var(--shadow-md);">
                            <p style="font-size: 0.8rem; color: #64748b; margin-top: 0.5rem; text-align: center;"><em>Von Th√ºnen's model: Concentric rings modified by a navigable river</em></p>
                        </div>
                        <div style="flex: 1; min-width: 300px;">
                            <h3 style="margin-top: 0;">The "Isolated State" Assumptions</h3>
                            <p>Von Th√ºnen imagined a perfectly isolated city-state with:</p>
                            <ul style="line-height: 1.8;">
                                <li>A single central <strong>market town</strong></li>
                                <li>Uniform flat terrain (an isotropic plain)</li>
                                <li>Equal soil fertility everywhere</li>
                                <li>No roads‚Äîonly horse-drawn carts radiating outward</li>
                                <li>Farmers who maximize profit (economic rationality)</li>
                            </ul>
                            
                            <h3>The Concentric Ring Pattern</h3>
                            <p>Under these conditions, <strong>land use arranges itself in concentric rings</strong> based on transportation cost:</p>
                            <ol style="line-height: 1.8;">
                                <li><strong>Ring 1 (Closest):</strong> Intensive farming‚Äîdairy, vegetables, fruits. These are perishable and heavy, so transport cost is critical.</li>
                                <li><strong>Ring 2:</strong> Forestry‚Äîwood for fuel and building is bulky and expensive to move.</li>
                                <li><strong>Ring 3:</strong> Grain crops‚Äîless perishable, can travel farther economically.</li>
                                <li><strong>Ring 4 (Farthest):</strong> Ranching/livestock‚Äîanimals walk themselves to market!</li>
                            </ol>
                        </div>
                    </div>

                    <div style="margin-top: 2rem; padding: 1.5rem; background: linear-gradient(135deg, #eff6ff 0%, #dbeafe 100%); border-radius: 12px; border-left: 5px solid #3b82f6;">
                        <h3 style="margin-top: 0; color: #1e40af;">üö¢ The Transportation Modification</h3>
                        <p style="color: #1e3a8a;">Von Th√ºnen recognized that his idealized rings would be <strong>distorted by transportation infrastructure</strong>. A navigable river or road extending from the city would:</p>
                        <ul style="color: #1e3a8a; line-height: 1.8;">
                            <li><strong>Lower transport costs</strong> along its corridor</li>
                            <li><strong>Stretch the rings outward</strong> like pulling taffy‚Äîintensive uses extend farther from the city along the river</li>
                            <li>Create a <strong>"wedge" or "finger"</strong> of inner-ring land uses penetrating into outer zones</li>
                        </ul>
                        <p style="color: #1e3a8a; margin-bottom: 0;"><strong>Modern Implication:</strong> This is why you see vegetable farms and dairies along highways and rail lines far from cities, while remote areas without good transportation remain as pasture or forest‚Äîexactly as Von Th√ºnen predicted 200 years ago!</p>
                    </div>

                    <div class="callout" style="margin-top: 1.5rem;">
                        <strong>üó∫Ô∏è Why This Matters for GIS:</strong>
                        <p style="margin-bottom: 0;">Von Th√ºnen's model is the intellectual ancestor of <strong>cost-distance analysis</strong> and <strong>accessibility modeling</strong> in GIS. When you calculate "travel time to the nearest hospital" or model urban sprawl, you're applying the same logic: <em>distance (or travel cost) from a central point determines spatial patterns.</em> Modern GIS simply replaces his uniform plain with real terrain, real roads, and real friction surfaces.</p>
                    </div>
                </section>

                <section class="card">
                    <h2>4. Neighborhoods & Proximity</h2>
                    <h3>Buffering</h3>
                    <p>Creating a zone of a specific distance around a feature. Useful for regulatory zones (e.g., "No drilling within 500ft of a house").</p>
                    
                    <h3>Interpolation</h3>
                    <p>Predicting values between known points. We use this to turn weather station points into a continuous temperature map (Isolines).</p>
                    
                    <h3>Theissen Polygons</h3>
                    <p>Mathematically defining the "catchment area" of a point. Any location inside a Theissen polygon is closer to that polygon's center point than any other point.</p>

                    <div class="callout warning" style="border-left-color: var(--accent); background: #fff1f2; margin-top: 2rem;">
                        <strong>üõë Critical GIS: The "Black Box" of Weights</strong>
                        <p>In the Suitability Studio above, you saw how changing weights changes the "best" site. In the real world, these weights are often decided by politicians or developers, not just data. If you weight "Property Value" higher than "Community Impact," your map will suggest gentrification. <strong>Algorithms are opinions embedded in code.</strong></p>
                    </div>
                </section>

                <div class="quiz-container">
                    <h2>Chapter 05 Checkpoint</h2>
                    <div class="question">
                        <p><strong>1. Which vector operation results in a layer containing ONLY the shared area between two inputs?</strong></p>
                        <button class="btn-quiz" onclick="checkAnswer(this, true)">Intersect</button>
                        <button class="btn-quiz" onclick="checkAnswer(this, false)">Union</button>
                        <button class="btn-quiz" onclick="checkAnswer(this, false)">Clip</button>
                    </div>
                    <div class="question">
                        <p><strong>2. In a weighted suitability model, if "Slope" is weighted at 60%, what does that imply?</strong></p>
                        <button class="btn-quiz" onclick="checkAnswer(this, true)">Slope is the most important factor in the model.</button>
                        <button class="btn-quiz" onclick="checkAnswer(this, false)">Slope has a 60% chance of being accurate.</button>
                    </div>
                </div>
            </div>

            <aside class="sidebar">
                <div class="sidebar-box">
                    <h3>Ian McHarg</h3>
                    <p><strong>The Father of Ecological Planning</strong></p>
                    <p>In his 1969 book <em>Design with Nature</em>, McHarg pioneered the "layer cake" method of suitability analysis using transparent acetate sheets. He would physically darken areas that were "unsuitable" for development (steep slopes, floodplains). By stacking the sheets, the optimal (lightest) areas revealed themselves. This is the manual ancestor of modern Map Algebra.</p>
                </div>

                <div class="sidebar-box">
                    <h3>Texas Connection</h3>
                    <p><strong>The Woodlands: A McHargian Design</strong></p>
                    <p>One of the most famous applications of Ian McHarg's ecological planning method is <strong>The Woodlands, Texas</strong>. In the 1970s, George Mitchell hired McHarg's firm to design a community north of Houston that respected the natural hydrology and forest cover. Instead of a concrete grid, they used suitability analysis to preserve drainage channels, resulting in a community that (mostly) withstands floods better than its neighbors.</p>
                </div>
            </aside>
        </div>

        <div class="chapter-nav" style="display: flex; justify-content: space-between; margin-top: 4rem; padding-top: 2rem; border-top: 1px solid #ddd;">
          <a href="chapter-04-gps.html" style="text-decoration: none; color: var(--secondary);">&larr; Chapter 04: GPS</a>
          <a href="chapter-06-output.html" style="text-decoration: none; color: var(--primary); font-weight: 700;">Chapter 06: Output &rarr;</a>
        </div>
    

        

        

        <section class="card bok-alignment" aria-label="Body of Knowledge alignment">
            <h2>BoK Alignment</h2>
            <p>
                Topics in the UCGIS GIS&amp;T Body of Knowledge that support this chapter.
            </p>
            <ul class="bok-topic-list">
                        <li class="bok-topic">
            <span class="bok-code">AM-01-020</span>
            <a href="https://gistbok-ltb.ucgis.org/page/34/concept/10469" target="_blank" rel="noopener noreferrer">Geospatial Analysis and Model Building</a>
        </li>
                        <li class="bok-topic">
            <span class="bok-code">AM-02-003</span>
            <a href="https://gistbok-ltb.ucgis.org/page/34/concept/10455" target="_blank" rel="noopener noreferrer">Buffers</a>
        </li>
                        <li class="bok-topic">
            <span class="bok-code">AM-02-004</span>
            <a href="https://gistbok-ltb.ucgis.org/page/34/concept/10456" target="_blank" rel="noopener noreferrer">Overlay</a>
        </li>
                        <li class="bok-topic">
            <span class="bok-code">AM-02-006</span>
            <a href="https://gistbok-ltb.ucgis.org/page/34/concept/10457" target="_blank" rel="noopener noreferrer">Grid Operations and Map Algebra</a>
        </li>
                        <li class="bok-topic">
            <span class="bok-code">AM-05-076</span>
            <a href="https://gistbok-ltb.ucgis.org/page/34/concept/10844" target="_blank" rel="noopener noreferrer">Network Route & Tour Problems in Geographic Information Systems</a>
        </li>
                        <li class="bok-topic">
            <span class="bok-code">GS-02-025</span>
            <a href="https://gistbok-ltb.ucgis.org/page/34/concept/10721" target="_blank" rel="noopener noreferrer">Spatial Decision Support</a>
        </li>
                        <li class="bok-topic">
            <span class="bok-code">BoK</span>
            <a href="https://gistbok-ltb.ucgis.org/" target="_blank" rel="noopener noreferrer">UCGIS GIS&T Body of Knowledge (Living Textbook)</a>
        </li>
            </ul>
        </section>

</main>

    <footer style="margin-top: 4rem; padding: 3rem 0; background: #f1f5f9; text-align: center;">
        <div class="container">
            <p>&copy; 2026 Dr. Moulay Anwar Sounny-Slitine. All Rights Reserved.</p>
            <p style="margin-top: 0.5rem; font-size: 0.9rem; color: #64748b;">
                Made with ‚ù§Ô∏è by <a href="https://sounny.github.io" target="_blank" style="color: #64748b; text-decoration: underline;">Dr. Sounny</a>
            </p>
        </div>
    </footer>

    <!-- DYNAMIC NAV SCRIPT -->
    <script>
      document.addEventListener('DOMContentLoaded', () => {
        const navTitle = document.querySelector('.nav-current-title');
        const defaultTitle = "Spatial Analysis"; // Dynamic default
        const sections = document.querySelectorAll('main h2');
        const navBar = document.querySelector('.sticky-chapter-bar');
        const progressBar = document.querySelector('.nav-progress-bar');
        
        // 1. Scroll Progress Bar
        window.addEventListener('scroll', () => {
          const winScroll = document.body.scrollTop || document.documentElement.scrollTop;
          const height = document.documentElement.scrollHeight - document.documentElement.clientHeight;
          const scrolled = (winScroll / height) * 100;
          if (progressBar) progressBar.style.width = scrolled + "%";
          
          if (window.scrollY > 200) {
            navBar.classList.add('is-stuck');
          } else {
            navBar.classList.remove('is-stuck');
          }
        });

        // 2. Section Observer for Dynamic Title
        const observerOptions = {
          root: null,
          rootMargin: '-80px 0px -70% 0px',
          threshold: 0
        };

        const observer = new IntersectionObserver((entries) => {
          entries.forEach(entry => {
            if (entry.isIntersecting) {
              const newText = entry.target.innerText;
              if (navTitle.textContent !== newText) {
                  navTitle.style.opacity = 0;
                  setTimeout(() => {
                    navTitle.textContent = newText;
                    navTitle.style.opacity = 1;
                  }, 200);
              }
            }
          });
        }, observerOptions);

        sections.forEach(section => {
          observer.observe(section);
        });
        
        // Reset to default
        window.addEventListener('scroll', () => {
          if (window.scrollY < 150) {
             if (navTitle.textContent !== defaultTitle) {
               navTitle.style.opacity = 0;
               setTimeout(() => {
                 navTitle.textContent = defaultTitle;
                 navTitle.style.opacity = 1;
               }, 200);
             }
          }
        });
      });

      // Quiz Logic
      function checkAnswer(el, isCorrect) {
          const parent = el.parentElement;
          const buttons = parent.querySelectorAll('.btn-quiz');
          buttons.forEach(btn => {
              btn.style.pointerEvents = 'none';
              btn.style.opacity = '0.5';
          });
          
          el.style.opacity = '1';
          if(isCorrect) {
              el.style.borderColor = 'var(--success)';
              el.style.background = '#ecfdf5';
              el.style.color = '#065f46';
          } else {
              el.style.borderColor = 'var(--accent)';
              el.style.background = '#fff1f2';
              el.style.color = '#9f1239';
          }
      }
    </script>

</body>
</html>
