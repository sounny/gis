<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chapter 04: GNSS & Positioning | GIS Digital Textbook</title>
    <meta name="description" content="Explore Global Navigation Satellite Systems (GNSS). Learn how GPS works, the three segments of navigation, and how to improve positioning accuracy.">
    <link rel="stylesheet" href="../css/style.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&family=Outfit:wght@300;400;600;800&display=swap" rel="stylesheet">
    <style>
        /* Chapter-specific styles */
        .hero-chapter {
            background: linear-gradient(
                135deg,
                rgba(30, 58, 138, 0.9) 0%,
                rgba(30, 58, 138, 0.8) 50%,
                rgba(59, 130, 246, 0.9) 100%
            ),
            url("../assets/img/hero_chapter04.png");
            background-size: cover;
            background-position: center;
            background-attachment: fixed;
            padding: 5rem 2rem;
            text-align: center;
            position: relative;
            overflow: hidden;
        }

        .hero-chapter .container {
            position: relative;
            z-index: 1;
        }

        .chapter-badge {
            display: inline-block;
            background: linear-gradient(135deg, #3b82f6, #60a5fa);
            color: white;
            padding: 0.5rem 1.5rem;
            border-radius: 30px;
            font-size: 0.9rem;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 0.15em;
            margin-bottom: 1.5rem;
            box-shadow: 0 4px 15px rgba(59, 130, 246, 0.4);
        }

        .hero-chapter h1 {
            font-size: clamp(2.5rem, 5vw, 4rem);
            margin-bottom: 1rem;
            background: linear-gradient(135deg, #ffffff 0%, #a8d8ea 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            text-shadow: 0 4px 10px rgba(0,0,0,0.3);
        }

        .hero-chapter .subtitle {
            font-size: 1.25rem;
            color: rgba(255, 255, 255, 0.9);
            max-width: 700px;
            margin: 0 auto 2rem;
            line-height: 1.7;
            text-shadow: 0 2px 4px rgba(0,0,0,0.3);
        }

        .layout-grid {
            display: grid;
            grid-template-columns: 1fr 340px;
            gap: 2rem;
            margin-top: 3rem;
        }

        @media (max-width: 1100px) {
            .layout-grid { grid-template-columns: 1fr; }
        }

        /* GNSS Table */
        .gnss-table { width: 100%; border-collapse: collapse; margin-top: 1rem; }
        .gnss-table th, .gnss-table td { padding: 0.75rem; border-bottom: 1px solid #eee; text-align: left; font-size: 0.9rem; }
        .gnss-table th { background: #f8fafc; font-weight: 700; }

        /* Elevation/Visualizer Styling */
        .viz-container { 
            background: #0f172a; 
            border-radius: 16px; 
            padding: 2rem; 
            color: #fff; 
            margin: 2rem 0; 
            text-align: center;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        }
        #gpsCanvas { 
            background: #000; 
            border: 1px solid #334155; 
            border-radius: 8px; 
            max-width: 100%; 
            height: auto; 
            cursor: crosshair;
        }

        .quiz-container { background: #f8fafc; padding: 2rem; border-radius: 16px; margin-top: 3rem; border: 1px solid #e2e8f0; }
        .btn-quiz {
            padding: 0.75rem 1rem;
            background: white;
            border: 2px solid #e2e8f0;
            border-radius: 8px;
            cursor: pointer;
            text-align: left;
            transition: all 0.2s;
            width: 100%;
            margin-bottom: 0.5rem;
        }
        .btn-quiz:hover { border-color: #3b82f6; background: #eff6ff; }
    </style>
</head>
<body>
    <header class="hero-chapter">
        <div class="container">
            <span class="chapter-badge">Chapter 04</span>
            <h1>GNSS & Positioning</h1>
            <p class="subtitle">
                Positioning on Earth. Discover the science behind Global Navigation Satellite Systems and the methods for achieving high-precision positioning across the globe.
            </p>
        </div>
    </header>

    <!-- STICKY NAVIGATION BAR -->
    <nav class="sticky-chapter-bar">
      <div class="nav-container">
        <div class="nav-left">
          <span class="nav-chapter-num">Chapter 04</span>
        </div>
        <div class="nav-center">
          <span class="nav-current-title">GNSS & Positioning</span>
        </div>
        <div class="nav-right">
          <a href="../index.html" class="nav-toc-btn" title="Table of Contents">
            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="8" y1="6" x2="21" y2="6"></line><line x1="8" y1="12" x2="21" y2="12"></line><line x1="8" y1="18" x2="21" y2="18"></line><line x1="3" y1="6" x2="3.01" y2="6"></line><line x1="3" y1="12" x2="3.01" y2="12"></line><line x1="3" y1="18" x2="3.01" y2="18"></line></svg>
            <span class="toc-text">TOC</span>
          </a>
        </div>
      </div>
      <div class="nav-progress-bar"></div>
    </nav>

    <main class="container">
        <section class="card learning-scaffold" aria-label="Learning scaffold">
            <details class="learning-scaffold-details">
                <summary>
                    <div class="scaffold-head">
                        <h2>At a Glance</h2>
                        <div class="scaffold-meta" aria-label="Prerequisites and time estimate">
                            <span class="scaffold-chip"><strong>Prereqs:</strong> Chapter 03</span>
                            <span class="scaffold-chip"><strong>Time:</strong> 20 min read + 20 min practice</span>
                            <span class="scaffold-chip"><strong>Deliverable:</strong> Field collection plan</span>
                        </div>
                    </div>
                </summary>

                <div class="scaffold-grid">
                    <div class="scaffold-card">
                        <h3>Learning outcomes</h3>
                        <ul>
                            <li>Explain how GNSS positioning works at a high level.</li>
                            <li>Identify factors that reduce accuracy (multipath, poor geometry).</li>
                            <li>Plan a basic field collection workflow for validation/GCPs.</li>
                        </ul>
                    </div>

                    <div class="scaffold-card">
                        <h3>Key terms</h3>
                        <p>GNSS, trilateration, multipath, DOP, differential correction, datum</p>
                    </div>
                </div>

                <div class="scaffold-grid">
                    <div class="scaffold-card">
                        <h3>Stop &amp; check</h3>
                        <ol class="scaffold-qa">
                            <li>
                                <details>
                                    <summary>What usually causes multipath error?</summary>
                                    <div>
                                        <p><strong>Answer:</strong> Signals reflecting off buildings/terrain before reaching the receiver.</p>
                                        <p><strong>Why:</strong> Reflections increase path length and bias the range estimate.</p>
                                        <p><strong>Common misconception:</strong> More satellites always guarantees better accuracy; geometry and environment matter.</p>
                                    </div>
                                </details>
                            </li>
                            <li>
                                <details>
                                    <summary>Why does CRS/datum matter for GNSS points?</summary>
                                    <div>
                                        <p><strong>Answer:</strong> Because coordinates depend on the reference model used.</p>
                                        <p><strong>Why:</strong> A mismatch can create consistent offsets between layers.</p>
                                        <p><strong>Common misconception:</strong> Latitude/longitude is universal and automatically matches every map.</p>
                                    </div>
                                </details>
                            </li>
                        </ol>
                    </div>

                    <div class="scaffold-card">
                        <h3>Try it (5 minutes)</h3>
                        <ol>
                            <li>List 3 places on campus/city where GNSS accuracy would likely be poor.</li>
                            <li>For each, write one mitigation (move, wait, repeat, use correction).</li>
                        </ol>
                    </div>
                </div>

                <div class="scaffold-grid">
                    <div class="scaffold-card">
                        <h3>Lab (Two Tracks)</h3>
                        <p>Both tracks produce the same deliverable: a one-page plan describing the collection of validation points for an imagery analysis.</p>
                        <div class="scaffold-two-track">
                            <div class="scaffold-track">
                                <h4>Desktop GIS Track (ArcGIS Pro / QGIS)</h4>
                                <p>Design a point feature class or form schema (fields + domains). Define required metadata (time, accuracy, notes).</p>
                            </div>
                            <div class="scaffold-track">
                                <h4>Remote Sensing Track (Google Earth Engine)</h4>
                                <p>Define an AOI and draft a validation sampling plan (how many points per class and where you would collect them).</p>
                            </div>
                        </div>
                    </div>

                    <div class="scaffold-card">
                        <h3>Common mistakes</h3>
                        <ul>
                            <li>Collecting points with unknown CRS/datum or missing metadata.</li>
                            <li>Taking one reading and assuming it is correct (no repeats).</li>
                            <li>Collecting under tree canopy/near buildings without noting expected error.</li>
                        </ul>
                        <p><strong>Further reading:</strong> https://gistbok-ltb.ucgis.org/</p>
                    </div>
                </div>
            </details>
        </section>


        <div class="layout-grid">
            <div class="content">
                <section class="card">
                    <h2>What is GNSS?</h2>
                    <p><strong>GNSS</strong> (Global Navigation Satellite System) is the umbrella term for satellite constellations that provide positioning, navigation, and timing (PNT) data. While <strong>GPS</strong> (Global Positioning System) is the most famous, it is actually just one of several systems operated worldwide. For official US government information, visit <a href="https://www.gps.gov/" target="_blank" style="color:var(--primary);">GPS.gov</a>.</p>
                    
                    <table class="gnss-table">
                        <thead>
                            <tr>
                                <th>System</th>
                                <th>Country</th>
                                <th>Status</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr><td>GPS</td><td>USA</td><td>Global</td></tr>
                            <tr><td>GLONASS</td><td>Russia</td><td>Global</td></tr>
                            <tr><td>Galileo</td><td>European Union</td><td>Global</td></tr>
                            <tr><td>BeiDou</td><td>China</td><td>Global</td></tr>
                        </tbody>
                    </table>
                </section>

                <section class="card">
                    <h2>The Three Segments</h2>
                    <ul style="line-height: 2;">
                        <li><strong>Space Segment:</strong> The constellation of satellites broadcasting signals.</li>
                        <li><strong>Control Segment:</strong> Ground stations that track satellites and upload orbital corrections.</li>
                        <li><strong>User Segment:</strong> A receiver (phone, car, survey gear) that calculates the position.</li>
                    </ul>
                </section>

                <section class="card">
                    <h2>‚ö†Ô∏è Why is GPS Inaccurate?</h2>
                    <p>Standard smartphone GPS is accurate to about 4.9 meters (16 ft). Why isn't it perfect? The signal travels 20,000 km and faces several hurdles:</p>
                    <div style="margin-top: 1rem;">
                        <div style="margin-bottom: 1rem; border-left: 4px solid var(--accent); padding-left: 1rem;">
                            <strong>1. Ionospheric Delay:</strong> Charged particles in the upper atmosphere slow down the radio waves. This is the biggest source of error.
                        </div>
                        <div style="margin-bottom: 1rem; border-left: 4px solid var(--accent); padding-left: 1rem;">
                            <strong>2. Multipath:</strong> In cities, signals bounce off glass buildings before hitting your phone. Your device thinks the satellite is further away than it is, causing your "blue dot" to jump across the street.
                        </div>
                        <div style="border-left: 4px solid var(--accent); padding-left: 1rem;">
                            <strong>3. Geometry (PDOP):</strong> If all visible satellites are clustered in one part of the sky, the triangulation is weak (high Dilution of Precision). You want them spread out.
                        </div>
                    </div>

                    <!-- Urban Canyon / Limited Sky View Section -->
                    <div style="margin-top: 2rem; padding: 1.5rem; background: linear-gradient(135deg, #fef3c7 0%, #fde68a 100%); border-radius: 12px; border: 2px solid #f59e0b;">
                        <h3 style="margin-top: 0; color: #92400e;">üèôÔ∏è The "Urban Canyon" Problem</h3>
                        <p style="color: #78350f;">When you're in a narrow canyon‚Äînatural or urban‚Äîbuildings or cliffs block large portions of the sky. Your GPS receiver may still get a position fix, but all the visible satellites come from the same narrow slice of sky, creating terrible geometry.</p>
                        
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 1.5rem; margin-top: 1.5rem;">
                            <div style="background: white; border-radius: 8px; padding: 1rem; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
                                <img src="../assets/img/Module7Pic1.png" alt="GPS receiver in canyon with limited sky view - satellites clustered in visible sky portion" style="width: 100%; border-radius: 6px; margin-bottom: 0.75rem;">
                                <p style="margin: 0; font-size: 0.85rem; color: #78350f;"><strong>Limited Sky View:</strong> In a canyon, only a small portion of the sky is visible. All available satellites are clustered in this narrow window, leading to poor PDOP values.</p>
                            </div>
                            <div style="background: white; border-radius: 8px; padding: 1rem; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
                                <img src="../assets/img/Module7Pic2.png" alt="Effect of poor satellite geometry on GPS accuracy" style="width: 100%; border-radius: 6px; margin-bottom: 0.75rem;">
                                <p style="margin: 0; font-size: 0.85rem; color: #78350f;"><strong>Poor Geometry = Poor Accuracy:</strong> Even though you may lock onto 4+ satellites, if they're all from the same part of the sky, the trilateration "intersection zone" becomes elongated and uncertain.</p>
                            </div>
                        </div>
                        
                        <p style="margin-top: 1rem; margin-bottom: 0; font-size: 0.9rem; color: #92400e;"><strong>üí° Real-World Example:</strong> This is why your phone's GPS often struggles in downtown Houston or Austin‚Äîthe tall buildings create artificial canyons that limit sky visibility, just like being at the bottom of a natural canyon in Big Bend.</p>
                    </div>
                </section>

                <section class="viz-container">
                    <h3>Accuracy Visualizer</h3>
                    <p style="color: #94a3b8; font-size: 0.8rem; margin-bottom: 1rem;">Reading satellite signals in real-time...</p>
                    <canvas id="gpsCanvas" width="400" height="300"></canvas>
                    <div style="margin-top: 1rem; font-family: monospace;" id="accuracy-readout">Accuracy: ¬±2.5m</div>
                </section>

                <section class="card">
                    <h2>üéØ The Quest for the Centimeter (RTK)</h2>
                    <p>For navigation, 5 meters is fine. For building a bridge, it is disastrous. Engineers use <strong>Real-Time Kinematic (RTK)</strong> to achieve 1 cm accuracy.</p>
                    <p><strong>How it works:</strong></p>
                    <ol>
                        <li><strong>Base Station:</strong> A receiver sits on a known coordinate and never moves. It calculates exactly how much the atmosphere is delaying the signal right now.</li>
                        <li><strong>Correction Signal:</strong> It broadcasts this "correction" via radio or internet.</li>
                        <li><strong>Rover:</strong> The mobile unit applies the correction instantly, removing the error.</li>
                    </ol>
                </section>

                <section class="card">
                    <h2>Interactive: Trilateration Simulator</h2>
                    <p>Drag the 3 satellites to see how their signal spheres overlap to pinpoint a location. Notice how poor geometry (satellites in a line) creates a larger area of uncertainty.</p>
                    
                    <div id="trilateration-sim" style="background:#0f172a; height:400px; border-radius:12px; position:relative; overflow:hidden; touch-action: none;">
                        <canvas id="triCanvas" width="800" height="400" style="width:100%; height:100%"></canvas>
                        <div style="position:absolute; bottom:10px; left:10px; color:white; font-family:monospace; background:rgba(0,0,0,0.5); padding:5px; border-radius:4px;">
                            Drag the satellites (üõ∞Ô∏è)!
                        </div>
                    </div>
                </section>

                <section class="card">
                    <h2>How Trilateration Works</h2>
                    <p>The core math behind GPS is <strong>Trilateration</strong>. It's like a high-tech version of triangulation, but using spheres instead of triangles.</p>
                    
                    <div style="display: flex; gap: 2rem; align-items: center; flex-wrap: wrap; margin-top: 2rem;">
                        <div style="flex: 1; min-width: 300px;">
                            <img src="../assets/img/diagrams/gps_trilateration.png" alt="GPS Trilateration Diagram" style="width: 100%; border-radius: 12px; box-shadow: var(--shadow-md);">
                        </div>
                        <div style="flex: 1; min-width: 300px;">
                            <ol style="line-height: 1.8;">
                                <li><strong>1 Satellite:</strong> The location exists on a sphere of radius $R_1$ from the satellite.</li>
                                <li><strong>2 Satellites:</strong> The intersection of two spheres is a <strong>circle</strong>. The location exists on that circle.</li>
                                <li><strong>3 Satellites:</strong> The intersection of the circle and a third sphere narrows it down to <strong>two points</strong>. One is usually way out in space, the other is on Earth.</li>
                                <li><strong>4 Satellites:</strong> The fourth sphere resolves the ambiguity and corrects for <strong>time bias</strong> in the receiver's clock. TV + 3D Position.</li>
                            </ol>
                            
                            <div class="callout warning" style="border-left-color: #ef4444; background: #fff1f2; color: #991b1b; margin-top:2rem;">
                                <strong>üõë Ethics: The "Strava" Problem</strong>
                                <p>GPS creates a digital trail of your life. In 2018, the fitness app Strava released a "Heatmap" of user runs. It inadvertently revealed secret US military bases because soldiers were tracking their jogs around the perimeter. <strong>Location Privacy</strong> is a massive ethical issue in GIS.</p>
                            </div>
                        </div>
                    </div>
                </section>

                <section class="card">
                    <h2>Summary of Big Ideas</h2>
                    <ul style="line-height: 1.8;">
                        <li><strong>Trilateration:</strong> The mathematical process of finding the location by measuring distances to 4 or more satellites.</li>
                        <li><strong>Differential GPS (DGPS):</strong> Using a stationary base station at a known point to correct errors for a mobile receiver.</li>
                        <li><strong>DOP (Dilution of Precision):</strong> A measure of how much the satellite geometry (positions) affects positioning accuracy.</li>
                        <li><strong>Error Sources:</strong> Atmospheric delays, signal multipath (bouncing off buildings), and orbital drift.</li>
                    </ul>
                </section>

                <div class="quiz-container">
                    <h2>Chapter 4 Checkpoint</h2>
                    <div class="question">
                        <p><strong>1. How many satellites are required to determine a 3D position (Lat, Lon, Alt) + Time?</strong></p>
                        <div class="option" onclick="this.classList.add('wrong')">3 Satellites</div>
                        <div class="option" onclick="this.classList.add('correct')">4 Satellites</div>
                    </div>
                    <div class="question">
                        <p><strong>2. Which component is responsible for uploading clock and orbital corrections to the satellites?</strong></p>
                        <div class="option" onclick="this.classList.add('wrong')">Space Segment</div>
                        <div class="option" onclick="this.classList.add('correct')">Control Segment</div>
                    </div>
                </div>

                <div class="section-glossary">
                    <h2>Chapter Glossary</h2>
                    <div class="glossary-list">
                        <div class="glossary-item">
                            <span class="glossary-term">GNSS (Global Navigation Satellite System)</span>
                            <span class="glossary-def">The general umbrella term for all satellite navigation constellations, including GPS (USA), Galileo (EU), GLONASS (Russia), and BeiDou (China).</span>
                        </div>
                        <div class="glossary-item">
                            <span class="glossary-term">Multipath Error</span>
                            <span class="glossary-def">A positioning error caused when satellite signals reflect off buildings or terrain before hitting the receiver, artificially extending the signal path.</span>
                        </div>
                        <div class="glossary-item">
                            <span class="glossary-term">Trilateration</span>
                            <span class="glossary-def">The mathematical method used by GPS receivers to calculate position by measuring distances to at least four satellites.</span>
                        </div>
                    </div>
                </div>
            </div>

            <aside class="sidebar">
                <div class="box-bio">
                    <img src="../assets/img/people/gladys_west.png" alt="Gladys West">
                    <div>
                        <h3>Dr. Gladys West</h3>
                        <p>A mathematician whose work at the U.S. Naval Proving Ground was essential to the development of the GPS system. She processed satellite data and developed the mathematical models of the Earth's shape (geoid) that every GPS receiver on Earth uses today to calculate height and location.</p>
                    </div>
                </div>

                <div class="box-bio">
                    <img src="../assets/img/people/greg_winfree.png" alt="Greg Winfree">
                    <div>
                        <h3>Greg Winfree</h3>
                        <p>A prominent national leader in <strong>Positioning, Navigation, and Timing (PNT)</strong> policy. Currently the Agency Director of the Texas A&M Transportation Institute (TTI), he previously served as Assistant Secretary at the U.S. DOT, overseeing the <strong>National Transportation Atlas Database (NTAD)</strong>. His research now integrates high-precision GNSS with "Smart Transportation" and automated vehicle (V2X) systems.</p>
                    </div>
                </div>

                <div class="sidebar-box" style="border-top-color: #64748b;">
                    <h3>Blast from the Past</h3>
                    <div style="position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden; border-radius: 8px; margin-bottom: 1rem;">
                        <iframe 
                            src="https://www.youtube.com/embed/EpA8Lf8Gt1Q?si=88jEwlEQZqstHtMj" 
                            style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; border: 0;"
                            title="1986: Satellite Navigation for Cars of the Future" 
                            allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" 
                            allowfullscreen></iframe>
                    </div>
                    <p style="font-size: 0.85rem; line-height: 1.4;">
                        <strong>1986: Satellite Navigation for Cars of the Future.</strong> 
                        "It may not look futuristic, but this is a highly intelligent car." 
                        BBC presenters explore the earliest concept cars using satellite guidance‚Äîlong before the technology was available to the public.
                    </p>
                </div>

                <div class="sidebar-local-global">
                    <h3>Texas Connection</h3>
                    <p><strong>GPS in the Permian Basin</strong></p>
                    <p>Texas is one of the world's leading energy producers. In the Permian Basin, GNSS is used for everything from the centimeter-precise placement of drilling rigs to tracking the fleets of trucks moving equipment across West Texas. Without high-precision GPS, the modern energy economy of Texas, and the global energy supply, would grind to a halt.</p>
                    <a href="https://www.txdot.gov/business/maintenance/precisionsurvey.html" target="_blank" class="btn btn-primary" style="margin-top:1rem; font-size:0.8rem; width:100%; text-align:center;">TxDOT Real-Time Network</a>
                </div>
            </aside>
        </div>

        <div class="chapter-nav" style="display: flex; justify-content: space-between; margin-top: 4rem; padding-top: 2rem; border-top: 1px solid #ddd;">
          <a href="chapter-03-projections.html" style="text-decoration: none; color: var(--secondary);">&larr; Chapter 3: Projections</a>
          <a href="chapter-06-digitizing.html" style="text-decoration: none; color: var(--primary); font-weight: 700;">Chapter 05: Digitizing Vector Data &rarr;</a>
        </div>
    

        

        

        <section class="card bok-alignment" aria-label="Body of Knowledge alignment">
            <h2>BoK Alignment</h2>
            <p>
                Topics in the UCGIS GIS&amp;T Body of Knowledge that support this chapter.
            </p>
            <ul class="bok-topic-list">
                        <li class="bok-topic">
            <span class="bok-code">DC-06-009</span>
            <a href="https://gistbok-ltb.ucgis.org/page/34/concept/10602" target="_blank" rel="noopener noreferrer">Field Data Capture Technologies</a>
        </li>
                        <li class="bok-topic">
            <span class="bok-code">DM-05</span>
            <a href="https://gistbok-ltb.ucgis.org/page/34/concept/10807" target="_blank" rel="noopener noreferrer">Georeferencing Systems</a>
        </li>
                        <li class="bok-topic">
            <span class="bok-code">BoK</span>
            <a href="https://gistbok-ltb.ucgis.org/" target="_blank" rel="noopener noreferrer">UCGIS GIS&T Body of Knowledge (Living Textbook)</a>
        </li>
            </ul>
        </section>

</main>

    <footer style="margin-top: 4rem; padding: 3rem 0; background: #f1f5f9; text-align: center;">
        <div class="container">
            <p>&copy; 2026 Dr. Moulay Anwar Sounny-Slitine. All Rights Reserved.</p>
        </div>
    </footer>

    <script>
        const canvas = document.getElementById('triCanvas');
        const ctx = canvas.getContext('2d');
        
        let sats = [
            { id: 1, x: 150, y: 100, r: 120, dragging: false, color: '#FF4444' },
            { id: 2, x: 650, y: 100, r: 120, dragging: false, color: '#44FF44' },
            { id: 3, x: 400, y: 300, r: 120, dragging: false, color: '#4444FF' }
        ];

        // Resize handling
        function resize() {
            canvas.width = canvas.parentElement.clientWidth;
            canvas.height = canvas.parentElement.clientHeight;
        }
        window.addEventListener('resize', resize);
        resize();

        // Mouse Events
        function getPos(e) {
            const rect = canvas.getBoundingClientRect();
            const x = (e.clientX || e.touches[0].clientX) - rect.left;
            const y = (e.clientY || e.touches[0].clientY) - rect.top;
            return {x, y};
        }

        canvas.addEventListener('mousedown', startDrag);
        canvas.addEventListener('touchstart', startDrag);
        window.addEventListener('mousemove', drag);
        window.addEventListener('touchmove', drag);
        window.addEventListener('mouseup', endDrag);
        window.addEventListener('touchend', endDrag);

        function startDrag(e) {
            const p = getPos(e);
            sats.forEach(s => {
                const dx = p.x - s.x;
                const dy = p.y - s.y;
                if(Math.sqrt(dx*dx + dy*dy) < 20) {
                    s.dragging = true;
                }
            });
        }

        function drag(e) {
            sats.forEach(s => {
                if(s.dragging) {
                    const p = getPos(e);
                    s.x = p.x;
                    s.y = p.y;
                }
            });
        }

        function endDrag() {
            sats.forEach(s => s.dragging = false);
        }

        function draw() {
            ctx.fillStyle = '#0f172a';
            ctx.fillRect(0,0,canvas.width, canvas.height);

            // Draw Target "Earth" Grid
            ctx.strokeStyle = '#334155';
            ctx.lineWidth = 1;
            for(let i=0; i<canvas.width; i+=50) {
                ctx.beginPath(); ctx.moveTo(i,0); ctx.lineTo(i,canvas.height); ctx.stroke();
            }
            for(let i=0; i<canvas.height; i+=50) {
                ctx.beginPath(); ctx.moveTo(0,i); ctx.lineTo(canvas.width,i); ctx.stroke();
            }

            // Draw Satellites & Signals
            sats.forEach(s => {
                // Signal Radius
                ctx.beginPath();
                ctx.arc(s.x, s.y, s.r, 0, Math.PI*2);
                ctx.strokeStyle = s.color;
                ctx.lineWidth = 2;
                ctx.stroke();
                ctx.fillStyle = s.color + '22'; // Transparent fill
                ctx.fill();

                // Satellite Icon
                ctx.font = "20px Arial";
                ctx.fillStyle = "white";
                ctx.fillText("üõ∞Ô∏è", s.x-10, s.y+5);
            });

            // Find Intersection (Approximate visual)
            // Just blending mode for visual "Overlap"
            ctx.globalCompositeOperation = 'lighter';
            sats.forEach(s => {
                ctx.beginPath();
                ctx.arc(s.x, s.y, s.r, 0, Math.PI*2);
                ctx.fillStyle = '#111';
                ctx.fill();
            });
            ctx.globalCompositeOperation = 'source-over';

            requestAnimationFrame(draw);
        }
        draw();

        // Accuracy Visualizer Logic
        const gpsCanvas = document.getElementById('gpsCanvas');
        const gpsCtx = gpsCanvas.getContext('2d');
        const readout = document.getElementById('accuracy-readout');
        
        let points = [];
        let centerX = 200;
        let centerY = 150;
        
        function drawAccuracy() {
            gpsCtx.fillStyle = 'rgba(0, 0, 0, 0.1)';
            gpsCtx.fillRect(0, 0, gpsCanvas.width, gpsCanvas.height);
            
            // Draw Target Rings
            gpsCtx.strokeStyle = '#1e293b';
            gpsCtx.beginPath(); gpsCtx.arc(centerX, centerY, 50, 0, Math.PI*2); gpsCtx.stroke();
            gpsCtx.beginPath(); gpsCtx.arc(centerX, centerY, 100, 0, Math.PI*2); gpsCtx.stroke();
            
            // Generate Random Walk "Signal"
            let error = 2 + Math.random() * 5;
            let angle = Math.random() * Math.PI * 2;
            let dist = Math.random() * error * 10;
            
            let x = centerX + Math.cos(angle) * dist;
            let y = centerY + Math.sin(angle) * dist;
            
            points.push({x, y, alpha: 1});
            if(points.length > 50) points.shift();
            
            points.forEach(p => {
                gpsCtx.fillStyle = `rgba(59, 130, 246, ${p.alpha})`;
                gpsCtx.beginPath();
                gpsCtx.arc(p.x, p.y, 3, 0, Math.PI*2);
                gpsCtx.fill();
                p.alpha -= 0.02;
            });
            
            readout.innerText = `Accuracy: ¬±${error.toFixed(2)}m`;
            requestAnimationFrame(drawAccuracy);
        }
        drawAccuracy();
    </script>

    <!-- DYNAMIC NAV SCRIPT -->
    <script>
      document.addEventListener('DOMContentLoaded', () => {
        const navTitle = document.querySelector('.nav-current-title');
        const defaultTitle = "GNSS & Positioning"; // Dynamic default
        const sections = document.querySelectorAll('main h2');
        const navBar = document.querySelector('.sticky-chapter-bar');
        const progressBar = document.querySelector('.nav-progress-bar');
        
        // 1. Scroll Progress Bar
        window.addEventListener('scroll', () => {
          const winScroll = document.body.scrollTop || document.documentElement.scrollTop;
          const height = document.documentElement.scrollHeight - document.documentElement.clientHeight;
          const scrolled = (winScroll / height) * 100;
          if (progressBar) progressBar.style.width = scrolled + "%";
          
          if (window.scrollY > 200) {
            navBar.classList.add('is-stuck');
          } else {
            navBar.classList.remove('is-stuck');
          }
        });

        // 2. Section Observer for Dynamic Title
        const observerOptions = {
          root: null,
          rootMargin: '-80px 0px -70% 0px',
          threshold: 0
        };

        const observer = new IntersectionObserver((entries) => {
          entries.forEach(entry => {
            if (entry.isIntersecting) {
              const newText = entry.target.innerText;
              if (navTitle.textContent !== newText) {
                  navTitle.style.opacity = 0;
                  setTimeout(() => {
                    navTitle.textContent = newText;
                    navTitle.style.opacity = 1;
                  }, 200);
              }
            }
          });
        }, observerOptions);

        sections.forEach(section => {
          observer.observe(section);
        });
        
        // Reset to default
        window.addEventListener('scroll', () => {
          if (window.scrollY < 150) {
             if (navTitle.textContent !== defaultTitle) {
               navTitle.style.opacity = 0;
               setTimeout(() => {
                 navTitle.textContent = defaultTitle;
                 navTitle.style.opacity = 1;
               }, 200);
             }
          }
        });
      });
    </script>

</body>
</html>
